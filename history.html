<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="description" content="">
  <meta name="author" content="">
  <link rel="shortcut icon" href="assets/img/logo-fav.png">
  <title>Beagle</title>
  <link rel="stylesheet" type="text/css" href="assets/lib/perfect-scrollbar/css/perfect-scrollbar.min.css" />
  <link rel="stylesheet" type="text/css"
    href="assets/lib/material-design-icons/css/material-design-iconic-font.min.css" /><!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  <link rel="stylesheet" type="text/css" href="assets/lib/datatables/css/dataTables.bootstrap.min.css" />
  <link rel="stylesheet" href="assets/css/style.css" type="text/css" />
  <script src=" https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
</head>

<body>
  <div class="be-wrapper">
    <nav class="navbar navbar-default navbar-fixed-top be-top-header">
      <div class="container-fluid">
        <div class="navbar-header"><a href="#" class="navbar-brand"></a>
        </div>
        <div class="be-right-navbar">
          <ul class="nav navbar-nav navbar-right be-user-nav">
            <li class="dropdown"><a href="#" data-toggle="dropdown" role="button" aria-expanded="false"
                class="dropdown-toggle"><img src="assets/img/avatar.png" alt="Avatar"><span class="user-name">TÃºpac
                  Amaru</span></a>
              <ul role="menu" class="dropdown-menu">
                <li>
                  <div class="user-info">
                    <div class="user-name" id="usernames"></div>
                    <div class="user-position online">Available</div>
                  </div>
                </li>
                <li><a href="#" onclick="logout()"><span class="icon mdi mdi-power"></span> Logout</a></li>
              </ul>
            </li>
          </ul>
          <div class="page-title"><span>Data Tables</span></div>
          <ul class="nav navbar-nav navbar-right be-icons-nav">
            <li class="dropdown"><a href="#" data-toggle="dropdown" role="button" aria-expanded="false"
                class="dropdown-toggle"><span class="icon mdi mdi-notifications"></span><span
                  class="indicator"></span></a>
              <ul class="dropdown-menu be-notifications">
                <li>
                  <div class="title">Notifications<span class="badge">3</span></div>
                  <div class="list">
                    <div class="be-scroller">
                      <div class="content">
                        <ul>
                          <li class="notification notification-unread"><a href="#">
                              <div class="image"><img src="assets/img/avatar2.png" alt="Avatar"></div>
                              <div class="notification-info">
                                <div class="text"><span class="user-name">Jessica Caruso</span> accepted your invitation
                                  to join the team.</div><span class="date">2 min ago</span>
                              </div>
                            </a></li>
                          <li class="notification"><a href="#">
                              <div class="image"><img src="assets/img/avatar3.png" alt="Avatar"></div>
                              <div class="notification-info">
                                <div class="text"><span class="user-name">Joel King</span> is now following you</div>
                                <span class="date">2 days ago</span>
                              </div>
                            </a></li>
                          <li class="notification"><a href="#">
                              <div class="image"><img src="assets/img/avatar4.png" alt="Avatar"></div>
                              <div class="notification-info">
                                <div class="text"><span class="user-name">John Doe</span> is watching your main
                                  repository</div><span class="date">2 days ago</span>
                              </div>
                            </a></li>
                          <li class="notification"><a href="#">
                              <div class="image"><img src="assets/img/avatar5.png" alt="Avatar"></div>
                              <div class="notification-info"><span class="text"><span class="user-name">Emily
                                    Carter</span> is now following you</span><span class="date">5 days ago</span></div>
                            </a></li>
                        </ul>
                      </div>
                    </div>
                  </div>
                  <div class="footer"> <a href="#">View all notifications</a></div>
                </li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <div class="be-left-sidebar">
      <div class="left-sidebar-wrapper"><a href="#" class="left-sidebar-toggle">Dashboard</a>
        <div class="left-sidebar-spacer">
          <div class="left-sidebar-scroll">
            <div class="left-sidebar-content">
              <ul class="sidebar-elements">
                <li class="divider">Menu</li>
                <li class="active"><a href="dashboard.html"><i class="icon mdi mdi-home"></i><span>Dashboard</span></a>
                </li>
                <li class="parent"><a href="#"><i class="icon mdi mdi-globe"></i><span>Upload</span></a>
                  <ul class="sub-menu">
                    <li><a href="upload.html">Upload</a>
                    </li>
                    <li><a href="history.html">History</a>
                    </li>
                  </ul>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="be-content">
      <div class="page-head">
        <h2 class="page-head-title">Data Tables</h2>
        <ol class="breadcrumb page-head-nav">
          <li><a href="#">Home</a></li>
          <li><a href="#">Tables</a></li>
          <li class="active">Data Site</li>
        </ol>
      </div>
      <div class="main-content container-fluid">
        <div class="row">
          <div class="col-sm-12">
            <div class="panel panel-default panel-table">
              <div class="panel-heading">Data Site
                <div class="tools"><span class="icon mdi mdi-download"></span><span
                    class="icon mdi mdi-more-vert"></span></div>
              </div>
              <div class="panel-body">
                <table id="table1" class="table table-striped table-hover table-fw-widget">
                  <thead>
                    <tr>
                      <th>ID</th>
                      <th>Site</th>
                      <th>Detail</th>
                    </tr>
                  </thead>
                  <tbody id="data_site">
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>


      </div>
    </div>
  </div>
  <script src="assets/lib/jquery/jquery.min.js" type="text/javascript"></script>
  <script src="assets/lib/perfect-scrollbar/js/perfect-scrollbar.jquery.min.js" type="text/javascript"></script>
  <script src="assets/js/main.js" type="text/javascript"></script>
  <script src="assets/lib/bootstrap/dist/js/bootstrap.min.js" type="text/javascript"></script>
  <script src="assets/lib/datatables/js/jquery.dataTables.min.js" type="text/javascript"></script>
  <script src="assets/lib/datatables/js/dataTables.bootstrap.min.js" type="text/javascript"></script>
  <script src="assets/lib/datatables/plugins/buttons/js/dataTables.buttons.js" type="text/javascript"></script>
  <script src="assets/lib/datatables/plugins/buttons/js/buttons.html5.js" type="text/javascript"></script>
  <script src="assets/lib/datatables/plugins/buttons/js/buttons.flash.js" type="text/javascript"></script>
  <script src="assets/lib/datatables/plugins/buttons/js/buttons.print.js" type="text/javascript"></script>
  <script src="assets/lib/datatables/plugins/buttons/js/buttons.colVis.js" type="text/javascript"></script>
  <script src="assets/lib/datatables/plugins/buttons/js/buttons.bootstrap.js" type="text/javascript"></script>
  <script src="assets/js/app-tables-datatables.js" type="text/javascript"></script>
  <script type="text/javascript">
    $(document).ready(function () {
      //initialize the javascript
      App.init();
      App.dataTables();
    });

    document.addEventListener("DOMContentLoaded", async (e) => {
      let cookie = {};
      var a = document.cookie.split(';');
      for (var i = 0; i < a.length; i++) {
        var b = a[i].split('=');
        var [key, value] = b;
        cookie[key.trim()] = value;
      }

      if (!cookie['username']) {
        window.location.replace('login.html');
      } else {
        let url = 'api.php?act=profile&un=' + cookie['username'];
        await fetch(url)
          .then(response => response.json())
          .then((data) => {
            document.getElementById("usernames").innerText = data?.username.toUpperCase();
          }).catch((error) => {
            console.log(error)
          })
      }
      await fetch('api.php?act=site')
        .then(resp => resp.json())
        .then((list) => {
          var html = ``;
          for (a = 0; a < list.length; a++) {
            html += `<tr class="odd gradeX"> <td>${list[a]?.id}</td> <td>${list[a]?.name}</td> <td> <a href="detail.html?id=${list[a]?.id}" class="btn btn-primary">Detail</a> </td> </tr>`;
          }
          document.getElementById('data_site').innerHTML = html;
        }).catch((error) => {
          console.log(error)
        })
    });


    function logout() {
      let cookie = {};
      var a = document.cookie.split(';');
      for (var i = 0; i < a.length; i++) {
        var b = a[i].split('=');
        var [key, value] = b;
        cookie[key.trim()] = value;
      }
      swal({
        title: "Are you sure?",
        text: "to Leave this Page ??",
        icon: "warning",
        buttons: true,
        dangerMode: true,
      })
        .then((willOut) => {
          if (willOut) {
            document.cookie = `username=${cookie['username']}; expires=Thu, 18 Dec 2013 12:00:00 UTC; path=/`;
            document.cookie = `username=${cookie['id_user']}; expires=Thu, 18 Dec 2013 12:00:00 UTC; path=/`;
            window.location.replace('login.html');
          } else {
            console.log('NaN')
          }
        });
    }

  </script>
</body>

</html>